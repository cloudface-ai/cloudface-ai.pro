# Optimized systemd service configuration
# Update /etc/systemd/system/cloudface-pro.service with these settings

[Unit]
Description=CloudFace Pro Flask Application
After=network.target

[Service]
Type=exec
User=www-data
Group=www-data
WorkingDirectory=/var/www/cloudface-pro
Environment="PATH=/var/www/cloudface-pro/venv/bin"
Environment="HOME=/home/www-data"
Environment="MPLCONFIGDIR=/tmp/matplotlib"
ExecStart=/var/www/cloudface-pro/venv/bin/gunicorn cloudface_pro_server:app \
    --bind 127.0.0.1:5002 \
    --workers 4 \
    --threads 8 \
    --worker-class gthread \
    --timeout 600 \
    --max-requests 1000 \
    --max-requests-jitter 100 \
    --access-logfile - \
    --error-logfile -
Restart=always
RestartSec=3

[Install]
WantedBy=multi-user.target
