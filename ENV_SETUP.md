# Environment Configuration Guide

## üìÅ Environment Files

We have 3 environment files:

1. **`.env.local`** - Local development with Razorpay TEST mode
2. **`.env.production`** - Production with Razorpay LIVE mode
3. **`.env`** - Active environment (git-ignored)

## üîÑ Switching Environments

### Quick Switch:
```bash
# Switch to local/test mode
./switch-env.sh local

# Switch to production/live mode
./switch-env.sh production
```

### Manual Switch:
```bash
# For local development
cp .env.local .env

# For production
cp .env.production .env
```

## üß™ Testing Locally with Test Mode

1. **Switch to local environment:**
   ```bash
   ./switch-env.sh local
   ```

2. **Start the server:**
   ```bash
   python web_server.py
   ```

3. **Use test card details:**
   - Card: `4111 1111 1111 1111`
   - CVV: Any 3 digits (e.g., `123`)
   - Expiry: Any future date (e.g., `12/25`)
   - OTP: `1234` (if prompted)

4. **View invoices:**
   - Login to Razorpay Dashboard
   - Toggle to **TEST MODE** (top-left)
   - Go to **Payments** section
   - Click on payment to download invoice PDF

## üöÄ Production Deployment

1. **On your VPS:**
   ```bash
   cd /var/www/cloudface_ai
   git pull origin main
   
   # Use production environment
   cp .env.production .env
   
   # Restart server
   source venv/bin/activate
   pkill -f web_server.py
   python3 web_server.py > server.log 2>&1 &
   ```

2. **Production uses LIVE mode:**
   - Real credit/debit cards only
   - Actual charges apply
   - Invoices sent to real customers

## üîë Key Differences

| Feature | Local (.env.local) | Production (.env.production) |
|---------|-------------------|------------------------------|
| Razorpay Mode | TEST | LIVE |
| Payment Cards | Test cards only | Real cards only |
| Charges | No real money | Real money charged |
| Invoice | Test invoice | Real invoice |
| Redirect URI | localhost:8550 | cloudface-ai.com |
| Flask Mode | development | production |

## ‚ö†Ô∏è Important Notes

1. **Never commit `.env` to git** - It's in .gitignore
2. **Always use local environment for testing** - Avoids accidental real charges
3. **Test cards don't work in LIVE mode** - And vice versa
4. **Keep your secrets safe** - Never share LIVE keys publicly

## üìß Invoice Configuration

Invoices are automatically generated by Razorpay for each successful payment.

**To configure automatic invoice emails:**
1. Login to Razorpay Dashboard
2. Go to Settings ‚Üí Receipts/Invoices
3. Enable "Email receipts to customers"
4. Customize email template (optional)

## üß™ Testing Invoice Generation

1. Switch to test mode: `./switch-env.sh local`
2. Start server: `python web_server.py`
3. Go to: http://localhost:8550/pricing
4. Select any plan and complete payment with test card
5. Check Razorpay Dashboard (TEST MODE) ‚Üí Payments
6. Click on payment ‚Üí Download invoice PDF

## üîç Troubleshooting

**Issue: "Authentication failed" error**
- Solution: Make sure you're using TEST keys locally and LIVE keys in production

**Issue: Test card not working**
- Solution: Verify you're in TEST mode (check .env file)

**Issue: Payment succeeds but no invoice**
- Solution: Check Razorpay Dashboard ‚Üí Settings ‚Üí Receipts/Invoices settings

## üìû Support

For questions, contact: support@cloudface-ai.com

